{% extends 'help_desk_base.html' %}

{% block body_content %}
    <div class="custom-default row">
        <div class="col-md-8">
            <form id="user-info">
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <input type="text" class="form-control chosen-container chosen-format" id="user-name" placeholder="First and Last Name">
                    </div>
                    <div class="form-group col-md-6">
                        <input type="text" class="form-control chosen-container chosen-format" id="user-username" placeholder="Username">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <input type="text" class="form-control chosen-container chosen-format" id="user-card-id" maxlength="5" placeholder="Card ID: 5 digit number on back of ID card">
                    </div>
                    <div class="form-group col-md-6">
                        <input type="button" class="btn btn-primary" id="add-row" value="Add User">
                    </div>
                </div>
            </form>
            <table id="user-table"  class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th></th>
                        <th data-toggle="tooltip" data-placement="top" title="Student Name">Name</th>
                        <th data-toggle="tooltip" data-placement="top" title="Student Username">Username</th>
                        <th data-toggle="tooltip" data-placement="top" title="Student Card ID">Card ID</th>
                    </tr>
                </thead>
                <tbody>
                    {% include 'users_table.html' %}
                </tbody>
            </table>
            <button type="button" class="btn btn-primary" id="delete-row">Delete User</button>
        </div>
    </div>
<script>
        $(document).ready(function() {
                $("#add-row").click(function() {
                        let student_name = $("#user-name").val();
                        let username = $("#user-username").val();
                        let card_id = $("#user-card-id").val();
                        let markup = "<tr><td><input type='checkbox' name='record'></td><td>" + student_name + "</td><td>" + username + "</td><td>" + card_id + "</td></tr>";
                        $("table tbody").append(markup);
                        let input_data = {
                            student_name: student_name,
                            username: username,
                            card_id: card_id
                        };
                        $.post('/users/users_table', input_data, function(output_data) {
                                $("#user-info")[0].reset();
                        });
                });
                $("#delete-row").click(function() {
                        $("table tbody").find('input[name="record"]').each(function() {
                                if($(this).is(":checked")) {
                                        $(this).parents("tr").remove();
                                }
                        });
                });
        });
</script>
{% endblock %}